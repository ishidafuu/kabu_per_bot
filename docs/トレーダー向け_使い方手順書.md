# kabu_per_bot 管理画面 使い方手順書

最終更新: 2026-02-15（JST）

この手順書は管理画面の `使い方` ページ（`/guide`）と同等内容です。

## 0. はじめに（このガイドでできること）

1. このガイドは、初めて使う方が「ログイン → 銘柄登録 → 状態確認」まで迷わず進めるための手順です。
2. まずは「1. 3分で始める」だけを実施すれば、基本操作は完了します。
3. 困ったときは「7. よくあるトラブル」の該当項目を確認してください。

## 1. 3分で始める（最短手順）

1. 管理画面へアクセス: `https://kabu-per-bot-487501.web.app`
2. ログイン画面でメールアドレス/パスワードを入力し、「Firebaseでログイン」を押します。
3. ダッシュボード右上の「ウォッチリストへ」を押します。
4. 「新規追加」を押して、例として ticker に `7203:TSE`、会社名に `トヨタ自動車` を入力します。
5. 通知設定は迷ったら `notify_channel=DISCORD`、`notify_timing=IMMEDIATE` のままで保存します。
6. 保存後、一覧に1件表示されれば初期設定は完了です。

## 2. 利用前の準備

1. Firebase Authentication にユーザー登録されたメールアドレス/パスワードが必要です。
2. 通知は Discord へ送信されるため、運用担当側で Webhook 設定済みであることを確認してください。
3. 本システムの時刻基準は JST（日本時間）です。

## 3. 画面ごとの役割（どこを見ればよいか）

1. ダッシュボード: 全体の状況確認（監視銘柄数、通知件数、失敗ジョブ有無）。
2. ウォッチリスト: 銘柄の追加・編集・削除を行うメイン画面。
3. 履歴: 追加/削除の操作履歴（いつ、何を変更したか）を確認。
4. 通知ログ: 実際に送信された通知内容を確認。
5. 使い方: この手順書を管理画面内で確認。

## 4. 入力ルール（最重要）

1. ticker は必ず `1234:TSE` 形式で入力します。
2. 正しい例: `7203:TSE` / `6758:TSE`
3. 誤り例: `7203`, `7203.T`, `7203:TYO`
4. `metric_type` は `PER` または `PSR` のどちらかを選択します。
5. 1アカウントで登録できる監視銘柄は最大100件です。

## 5. 通知設定の選び方（迷ったらここだけ）

1. `notify_channel=DISCORD`: 通知を受け取る（通常はこちら）。
2. `notify_channel=OFF`: その銘柄だけ通知しない。
3. `notify_timing=IMMEDIATE`: 日次ジョブ側で通知対象。
4. `notify_timing=AT_21`: 21時系ジョブ側で通知対象。
5. `notify_timing=OFF`: 通知対象外。
6. 同じ条件の通知は2時間クールダウンで自動的に重複抑制されます。

## 6. 追加・編集・削除のやり方

1. 追加: ウォッチリスト画面で「新規追加」→入力→保存。
2. 編集: 一覧行の「編集」→変更→保存。
3. 削除: 一覧行の「削除」→確認ダイアログで確定。
4. 削除や追加の記録は履歴画面で確認できます。

## 7. よくあるトラブル（先にここを見る）

1. ログインできない: メールアドレス/パスワードの再確認、Firebase Auth の登録状態を確認。
2. APIに接続できません: いったんログアウトし、ページ再読み込み後に再ログイン。
3. 一覧にデータが出ない: ticker形式、検索条件（絞り込み）、該当銘柄の登録有無を確認。
4. 通知が来ない: `notify_channel` が `OFF` になっていないか、`notify_timing` 設定を確認。

## 8. 日々の運用チェック（おすすめ）

1. 毎日1回、ダッシュボードの「失敗ジョブ有無」を確認。
2. 「あり」の場合は通知ログと履歴を確認し、運用担当へ連携。
3. 銘柄変更を行った日は、履歴画面に操作記録が残っていることを確認。

## 9. 既知事項

1. AI通知は現時点で未実装です（画面上にも未実装表示あり）。
2. 通知チャネルは Discord のみ対応です。
